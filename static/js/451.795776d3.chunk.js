(self.webpackChunkkanban=self.webpackChunkkanban||[]).push([[451],{2434:(e,o,n)=>{"use strict";n.r(o),n.d(o,{default:()=>N});var r=n(5043),t=n(1906),i=n(5376),s=n(3216),l=n(5475),c=n(8903),a=n(6446),d=n(5865),u=n(7872),h=n(8279),p=n(5969),m=n(3892),v=n(899),w=n(852),f=n(1036),g=n(7394);const x="http://localhost:8000",y=async e=>{const o=await e.json();if(!e.ok)throw new Error(o.message||"Something went wrong");return o},S=async()=>{try{const e=await fetch(`${x}/users`);return y(e)}catch(e){throw console.error("Error fetching users:",e),e}};var A=n(3003),b=n(9682),j=n(1692);const k=(0,r.createContext)(null);function E(e){let{clientId:o,nonce:n,onScriptLoadSuccess:t,onScriptLoadError:i,children:s}=e;const l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{nonce:o,onScriptLoadSuccess:n,onScriptLoadError:t}=e,[i,s]=(0,r.useState)(!1),l=(0,r.useRef)(n);l.current=n;const c=(0,r.useRef)(t);return c.current=t,(0,r.useEffect)((()=>{const e=document.createElement("script");return e.src="https://accounts.google.com/gsi/client",e.async=!0,e.defer=!0,e.nonce=o,e.onload=()=>{var e;s(!0),null===(e=l.current)||void 0===e||e.call(l)},e.onerror=()=>{var e;s(!1),null===(e=c.current)||void 0===e||e.call(c)},document.body.appendChild(e),()=>{document.body.removeChild(e)}}),[o]),i}({nonce:n,onScriptLoadSuccess:t,onScriptLoadError:i}),c=(0,r.useMemo)((()=>({clientId:o,scriptLoadedSuccessfully:l})),[o,l]);return r.createElement(k.Provider,{value:c},s)}function C(){const e=(0,r.useContext)(k);if(!e)throw new Error("Google OAuth components must be used within GoogleOAuthProvider");return e}function R(e){var o;return null!==(o=null===e||void 0===e?void 0:e.clientId)&&void 0!==o?o:null===e||void 0===e?void 0:e.client_id}const _={large:40,medium:32,small:20};function I(e){let{onSuccess:o,onError:n,useOneTap:t,promptMomentNotification:i,type:s="standard",theme:l="outline",size:c="large",text:a,shape:d,logo_alignment:u,width:h,locale:p,click_listener:m,containerProps:v,...w}=e;const f=(0,r.useRef)(null),{clientId:g,scriptLoadedSuccessfully:x}=C(),y=(0,r.useRef)(o);y.current=o;const S=(0,r.useRef)(n);S.current=n;const A=(0,r.useRef)(i);return A.current=i,(0,r.useEffect)((()=>{var e,o,n,r,i,v,b,j,k;if(x)return null===(n=null===(o=null===(e=null===window||void 0===window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===o?void 0:o.id)||void 0===n||n.initialize({client_id:g,callback:e=>{var o;if(!(null===e||void 0===e?void 0:e.credential))return null===(o=S.current)||void 0===o?void 0:o.call(S);const{credential:n,select_by:r}=e;y.current({credential:n,clientId:R(e),select_by:r})},...w}),null===(v=null===(i=null===(r=null===window||void 0===window?void 0:window.google)||void 0===r?void 0:r.accounts)||void 0===i?void 0:i.id)||void 0===v||v.renderButton(f.current,{type:s,theme:l,size:c,text:a,shape:d,logo_alignment:u,width:h,locale:p,click_listener:m}),t&&(null===(k=null===(j=null===(b=null===window||void 0===window?void 0:window.google)||void 0===b?void 0:b.accounts)||void 0===j?void 0:j.id)||void 0===k||k.prompt(A.current)),()=>{var e,o,n;t&&(null===(n=null===(o=null===(e=null===window||void 0===window?void 0:window.google)||void 0===e?void 0:e.accounts)||void 0===o?void 0:o.id)||void 0===n||n.cancel())}}),[g,x,t,s,l,c,a,d,u,h,p]),r.createElement("div",{...v,ref:f,style:{height:_[c],...null===v||void 0===v?void 0:v.style}})}class P extends Error{}function L(e){let o=e.replace(/-/g,"+").replace(/_/g,"/");switch(o.length%4){case 0:break;case 2:o+="==";break;case 3:o+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,((e,o)=>{let n=o.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(o)}catch(n){return atob(o)}}P.prototype.name="InvalidTokenError";var T=n(579);const D={NODE_ENV:"production",PUBLIC_URL:"/Todo-KanbanBoard",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_CLIENT_ID,O=(0,h.A)(),U=v.Ik({identifier:v.Yj().required("Username or Email is required").test("is-valid-identifier","Enter a valid email or username",(e=>{const o=v.Yj().email().isValidSync(e),n=v.Yj().min(3).max(20).isValidSync(e);return o||n})),password:v.Yj().required("Password is required"),captcha:v.Yj().required("Captcha is required")});function N(){const e=(0,A.wA)(),o=(0,s.Zp)(),[n,h]=(0,r.useState)(!1),v=(0,m.Wx)({initialValues:{identifier:"",password:"",captcha:""},validationSchema:U,onSubmit:async n=>{if((0,w.JF)(n.captcha)){console.log(n);try{const r=await S(),t=r.find((e=>(e.email===n.identifier||e.username===n.identifier)&&e.password===n.password));if(t)f.oR.success("Login successful"),o("/dashboard"),sessionStorage.setItem("token","token"),e((0,b.Ne)(t)),e((0,j.$U)(null===t||void 0===t?void 0:t.tasks));else{r.find((e=>e.email===n.identifier||e.username===n.identifier))?f.oR.error("Invalid password"):f.oR.error("User not found")}}catch(r){f.oR.error("An error occurred while trying to log in"),console.error("Login error:",r)}}else f.oR.error("Captcha not Matched")}});return(0,r.useEffect)((()=>{(0,w.kv)(6)}),[]),(0,T.jsx)(p.A,{theme:O,children:(0,T.jsxs)(u.A,{component:"main",maxWidth:"xs",sx:{mt:3,mb:2},children:[(0,T.jsx)(i.Ay,{}),(0,T.jsxs)(a.A,{sx:{marginTop:8,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,T.jsx)(d.A,{component:"h1",variant:"h5",children:"Log-in"}),(0,T.jsxs)(a.A,{component:"form",onSubmit:v.handleSubmit,sx:{mt:3},children:[(0,T.jsxs)(c.Ay,{container:!0,spacing:2,children:[(0,T.jsx)(c.Ay,{item:!0,xs:12,children:(0,T.jsx)(g.A,{name:"identifier",label:"Username or Email",formik:v})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,children:(0,T.jsx)(g.A,{name:"password",label:"Password",formik:v,type:"password",showPassword:n,handleClickShowPassword:()=>h(!n),handleMouseDownPassword:e=>{e.preventDefault()}})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,children:(0,T.jsx)(w.FZ,{reloadText:"Reload Captcha",reloadColor:"red"})}),(0,T.jsx)(c.Ay,{item:!0,xs:12,children:(0,T.jsx)(g.A,{name:"captcha",label:"Enter Captcha Value",formik:v})})]}),(0,T.jsx)(t.A,{type:"submit",fullWidth:!0,variant:"contained",sx:{mt:3,mb:2},children:"Login"}),(0,T.jsx)(E,{clientId:D,children:(0,T.jsx)(I,{onSuccess:async n=>{try{const r=n.credential,t=function(e,o){if("string"!==typeof e)throw new P("Invalid token specified: must be a string");o||(o={});const n=!0===o.header?0:1,r=e.split(".")[n];if("string"!==typeof r)throw new P(`Invalid token specified: missing part #${n+1}`);let t;try{t=L(r)}catch(i){throw new P(`Invalid token specified: invalid base64 for part #${n+1} (${i.message})`)}try{return JSON.parse(t)}catch(i){throw new P(`Invalid token specified: invalid json for part #${n+1} (${i.message})`)}}(r);console.log("response==",n,t);const i=t.email,s=(await S()).find((e=>e.email===i));s?(f.oR.success("Login successful"),o("/dashboard"),sessionStorage.setItem("token",r),e((0,b.Ne)(s)),e((0,j.$U)(null===s||void 0===s?void 0:s.tasks))):f.oR.error("User not found")}catch(r){f.oR.error("An error occurred while trying to log in with Google"),console.error("Google login error:",r)}},onError:()=>{f.oR.error("Google Login Failed")},useOneTap:!0})}),(0,T.jsx)(c.Ay,{container:!0,justifyContent:"center",children:(0,T.jsx)(c.Ay,{item:!0,children:(0,T.jsx)(l.N_,{to:"/register",children:"Don't have an account? Sign Up"})})})]})]})]})})}},5098:()=>{},7394:(e,o,n)=>{"use strict";n.d(o,{A:()=>a});n(5043);var r=n(5795),t=n(7392),i=n(1787),s=n(7260),l=n(2819),c=n(579);const a=e=>{let{name:o,label:n,formik:a,type:d="text",showPassword:u=!1,handleClickShowPassword:h,handleMouseDownPassword:p}=e;return(0,c.jsx)(r.A,{fullWidth:!0,id:o,name:o,label:n,type:"password"===d&&u?"text":d,...a.getFieldProps(o),error:a.touched[o]&&Boolean(a.errors[o]),helperText:a.touched[o]&&a.errors[o],InputProps:{..."password"===d&&{endAdornment:(0,c.jsx)(i.A,{position:"end",children:(0,c.jsx)(t.A,{"aria-label":"toggle password visibility",onClick:h,onMouseDown:p,edge:"end",children:u?(0,c.jsx)(l.A,{}):(0,c.jsx)(s.A,{})})})}}})}}}]);
//# sourceMappingURL=451.795776d3.chunk.js.map